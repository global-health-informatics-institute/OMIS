<h4>Travel Request</h4>
<hr>

<%= form_with model: @requisition, url: create_travel_requests_path do |form| %> <%# Reverted URL to create_travel_request_path as per your route %>

  <div class="row">
    <div class="col-3">
      <%= form.label :Vehicle %>
      <%= form.text_field :vehicle, class: 'form-control', required: true %>
    </div>
    <div class="col-md-4">
      <%= form.label :destination %>
      <%= form.text_field :destination, class: 'form-control', required: true %>
    </div>
 <div class="col-md-3 mb-3">
      <div>
        Project
      </div>
      <div>
        <%= form.select :project_id, options_for_select(@project_options, (@selected_project.id rescue nil)),
                        prompt:(@selected_project.full_name rescue params[:"prj"]),
                        :class => 'form-control', required: true %>
      </div>
    </div>
  </div>

  <div class="row mt-4">
    <div class="col-3">
      <%= form.label :departure_date, "Departure Date" %>
      <%= form.date_field :departure_date, class: 'form-control', required: true %>
    </div>
    <div class="col-4">
      <%= form.label :return_date, "Return Date" %>
      <%= form.date_field :return_date, class: 'form-control', required: true %> <%# Corrected field name to :return_date %>
    </div>
    <div class="col-md-4 mb-4">
      <%= form.label :purpose %>
      <%= form.text_field :purpose, class: 'form-control', required: true %>
    </div>
  </div>

  <div class="row mt-4"> <%# This is the row for Amount, Distance, and Travellers %>
    <div class="col-md-3 mb-3">
      <%= form.label :amount_requested, "Amount Requested" %>
      <%= form.number_field :amount_requested, step:0.00, max: 100000.00, class: 'form-control', required: true %>
    </div>
    <div class="col-md-4 mb-4">
      <%= form.label :distance %>
      <%= form.number_field :distance, step:0.00, max: 200.00, min: 0, class: 'form-control', required: true %>
    </div>
    <%# Moved "Names of Travellers" here, as a direct child of the row %>
    <div class="col-md-3 mb-3">
        <%= form.label :traveller_ids, "Names of Travellers" %>
    <div class="form-control" style="height: auto; max-height: 100px; overflow-y: auto;">
      <% @employees.each do |employee| %>
        <div class="form-check">
          <%= form.check_box :employee_ids, {
                multiple: true,
                class: 'form-check-input',
                checked: form.object.employee_ids&.include?(employee)
              }, employee, nil %>
          <%= form.label "employee_ids_#{employee}", employee, class: 'form-check-label' %>
        </div>
      <% end %>
    </div>
  </div>

  <%# External Travellers Table - remains in its own row %>
  
  <%# Buttons section - moved inside form_with and correctly styled %>
  <div class="row mt-4">
    <div class="col-auto">
      <%= form.submit "Submit Request", class: "btn btn-success" %>
    </div>
    <div class="col-auto">
      <button type="button" class="btn btn-danger ms-2">Cancel</button>
    </div>
  </div>

<% end %>