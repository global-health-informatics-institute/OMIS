

<%# GENDER - PIE CHART %>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const ctx = document.getElementById('genderChart')?.getContext('2d');
    if (!ctx) return; // Safeguard

    new Chart(ctx, {
      type: 'doughnut',
      data: {
        labels: ['Female', 'Male', 'Other'],
        datasets: [{
          data: [<%= @gender_age[:gender_female] %>, <%= @gender_age[:gender_male] %>, <%= @gender_age[:gender_other] %>],
          backgroundColor: ['#FBB6CE', '#2C5282', '#6B7280'],
          borderWidth: 0,
        }]
      },
      options: {
        cutout: '60%',
        plugins: {
          legend: { display: false },
          tooltip: {
            callbacks: {
              label: context => `${context.label}: ${context.parsed}%`
            }
          }
        }
      }
    });
  });
</script>

<%# AGE - BAR GRAPH %>
<script>
  const ageCtx = document.getElementById('ageChart').getContext('2d');
  new Chart(ageCtx, {
    type: 'bar',
    data: {
      labels: ['18-24', '25-29', '30-44', '45-60', '60+'],
      datasets: [{
        label: 'Employees',
        data: [
          <%=@gender_age[:age_18_25]%>,
          <%=@gender_age[:age_26_35]%>,
          <%=@gender_age[:age_36_45]%>,
          <%=@gender_age[:age_46_55]%>,
          <%=@gender_age[:age_56_65]%>,
          <%=@gender_age[:above_65]%>,
        ],
        backgroundColor: [
          'rgba(191, 219, 254, 0.8)',  // light blue
          'rgba(110, 231, 183, 0.9)',  // mint
          'rgba(34, 197, 94, 0.9)',    // green
          'rgba(20, 184, 166, 0.9)',   // teal
          'rgba(203, 213, 225, 0.8)'   // gray (zero value)
        ],
        borderRadius: 11,
        barThickness: 86
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      scales: {
        x: {
          grid: { color: '#E5E7EB' },
          ticks: {
            color: '#4B5563',
            font: { size: 26, weight: '800' }
          }
        },
        y: {
          grid: { color: '#E5E7EB' },
          ticks: {
            beginAtZero: true,
            stepSize: 10,
            color: '#4B5563',
            font: { size: 24, weight: '800' }
          }
        }
      },
      plugins: {
        legend: { display: false },
        tooltip: {
          callbacks: {
            label: context => ` ${context.parsed.y} employees`
          }
        }
      }
    }
  });
</script>
